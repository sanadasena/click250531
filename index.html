<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¯ãƒªãƒƒã‚¯ã§å¼·ããªã‚‹ã‚²ãƒ¼ãƒ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .game-container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* rounded-3xl */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* shadow-xl */
            padding: 2rem;
            text-align: center;
            width: 100%;
            max-width: 600px;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }
        .btn {
            padding: 1rem 2rem;
            border-radius: 0.75rem; /* rounded-xl */
            font-weight: 700; /* font-bold */
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
        }
        .btn-primary {
            background-image: linear-gradient(to right, #6366f1, #8b5cf6); /* from-indigo-500 to-purple-600 */
            color: white;
        }
        .btn-primary:hover {
            background-image: linear-gradient(to right, #4f46e5, #7c3aed); /* from-indigo-600 to-purple-700 */
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .btn-secondary {
            background-color: #e2e8f0; /* bg-slate-200 */
            color: #334155; /* text-slate-700 */
        }
        .btn-secondary:hover {
            background-color: #cbd5e1; /* bg-slate-300 */
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .btn-premium {
            background-image: linear-gradient(to right, #f59e0b, #ef4444); /* from-amber-500 to-red-500 */
            color: white;
        }
        .btn-premium:hover {
            background-image: linear-gradient(to right, #d97706, #dc2626); /* from-amber-600 to-red-600 */
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .btn-gacha {
            background-image: linear-gradient(to right, #10b981, #06b6d4); /* from-emerald-500 to-cyan-500 */
            color: white;
        }
        .btn-gacha:hover {
            background-image: linear-gradient(to right, #059669, #0891b2); /* from-emerald-600 to-cyan-600 */
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .upgrade-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #f8fafc; /* bg-slate-50 */
            padding: 1rem;
            border-radius: 0.75rem; /* rounded-xl */
            border: 1px solid #e2e8f0; /* border-slate-200 */
        }
        .upgrade-item button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            pointer-events: none; /* Allows clicks to pass through */
        }
        .message-box.show {
            opacity: 1;
        }
        .character-list {
            max-height: 150px; /* Adjust as needed */
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.5rem;
            background-color: #f8fafc;
        }
        .character-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        .character-item:last-child {
            border-bottom: none;
        }

        /* --- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆé–¢é€£ã®CSS --- */
        #effectContainer {
            position: fixed; /* ç”»é¢å…¨ä½“ã«å›ºå®š */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€éã•ã›ã‚‹ */
            overflow: hidden; /* ç”»é¢å¤–ã«å‡ºãŸã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’éè¡¨ç¤º */
            z-index: 999; /* ä»–ã®è¦ç´ ã®ä¸Šã«è¡¨ç¤º */
        }

        .particle {
            position: absolute;
            border-radius: 50%; /* å††å½¢ */
            opacity: 0;
            transform: translate(-50%, -50%) scale(0); /* åˆæœŸçŠ¶æ…‹ã¯ä¸­å¤®ã«å°ã•ã */
            animation: particle-fade-move 1s forwards ease-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        }

        /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */
        @keyframes particle-fade-move {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0); /* åˆæœŸã¯é€æ˜ã§å°ã•ã„ */
            }
            50% {
                opacity: 0.8;
                transform: translate(var(--translate-x), var(--translate-y)) scale(1); /* ä¸­é–“ã§å°‘ã—ç§»å‹•ã—æ‹¡å¤§ */
            }
            100% {
                opacity: 0;
                transform: translate(var(--translate-x), var(--translate-y)) scale(1.5); /* æœ€çµ‚çš„ã«é€æ˜ã«ãªã‚Šã•ã‚‰ã«æ‹¡å¤§ */
            }
        }
        /* --- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆé–¢é€£ã®CSSçµ‚ --- */

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .game-container {
                padding: 1.5rem;
            }
            .btn {
                padding: 0.75rem 1.5rem;
                font-size: 0.9rem;
            }
            .upgrade-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            .upgrade-item button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-4">ã‚¯ãƒªãƒƒã‚¯ã§å¼·ããªã‚‹ã‚²ãƒ¼ãƒ </h1>

        <div class="bg-blue-100 text-blue-800 p-3 rounded-lg mb-4 font-semibold text-lg">
            ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã‹ã‚‰ã®æ™‚é–“: <span id="elapsedTimeDisplay">0æ—¥0æ™‚é–“0åˆ†0ç§’,000ç§’</span>
        </div>

        <div class="flex flex-col md:flex-row justify-around items-center gap-4 text-xl font-semibold text-gray-700">
            <p>ç¾åœ¨ã®åŠ›: <span id="powerDisplay" class="text-indigo-600 text-3xl">0</span></p>
            <p>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨: <span id="premiumCurrencyDisplay" class="text-amber-500 text-3xl">0</span></p>
            <p>ç¾åœ¨ã®ã‚¯ãƒªãƒƒã‚¯åŠ›: <span id="currentClickPowerDisplay" class="text-purple-600 text-3xl">1</span></p>
        </div>

        <button id="clickButton" class="btn btn-primary text-2xl mt-4">
            <span class="mr-2">ğŸ’ª</span> ã‚¯ãƒªãƒƒã‚¯ã—ã¦åŠ›ã‚’å¾—ã‚‹ï¼
        </button>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
            <div class="col-span-full text-2xl font-bold text-gray-800 mb-2">ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</div>

            <div class="upgrade-item">
                <div>
                    <p class="font-bold text-lg">ã‚¯ãƒªãƒƒã‚¯åŠ›å¼·åŒ–</p>
                    <p class="text-sm text-gray-600">ã‚¯ãƒªãƒƒã‚¯ã‚ãŸã‚Šã®åŠ›ãŒ<span id="clickPowerUpgradeValue">1</span>å¢—åŠ </p>
                    <p class="text-sm text-gray-600">ã‚³ã‚¹ãƒˆ: <span id="clickPowerUpgradeCost">10</span> åŠ›</p>
                </div>
                <button id="buyClickPowerUpgrade" class="btn btn-secondary text-base">è³¼å…¥</button>
            </div>

            <div class="upgrade-item">
                <div>
                    <p class="font-bold text-lg">è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯</p>
                    <p class="text-sm text-gray-600">æ¯ç§’<span id="autoClickValue">0</span>ã®åŠ›ã‚’è‡ªå‹•ç²å¾—</p>
                    <p class="text-sm text-gray-600">ã‚³ã‚¹ãƒˆ: <span id="autoClickCost">100</span> åŠ›</p>
                </div>
                <button id="buyAutoClickUpgrade" class="btn btn-secondary text-base">è³¼å…¥</button>
            </div>
        </div>

        <div class="mt-6">
            <div class="col-span-full text-2xl font-bold text-gray-800 mb-2">ã‚¬ãƒãƒ£</div>
            <div class="upgrade-item">
                <div>
                    <p class="font-bold text-lg">ã‚­ãƒ£ãƒ©ã‚¬ãƒãƒ£</p>
                    <p class="text-sm text-gray-600">æ–°ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ã‚²ãƒƒãƒˆï¼</p>
                    <p class="text-sm text-gray-600">ã‚³ã‚¹ãƒˆ: <span id="gachaCost">500</span> åŠ›</p>
                </div>
                <button id="drawGacha" class="btn btn-gacha text-base">ã‚¬ãƒãƒ£ã‚’å¼•ã</button>
            </div>
            <div class="mt-4">
                <p class="text-lg font-semibold text-gray-800">æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼:</p>
                <div id="ownedCharactersList" class="character-list">
                    <p class="text-gray-500 text-sm italic">ã¾ã ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã„ã¾ã›ã‚“ã€‚</p>
                </div>
            </div>
        </div>

        <div class="mt-6">
            <div class="col-span-full text-2xl font-bold text-gray-800 mb-2">èª²é‡‘è¦ç´ </div>
            <div class="upgrade-item">
                <div>
                    <p class="font-bold text-lg">ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨è³¼å…¥</p>
                    <p class="text-sm text-gray-600">100 ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ã‚’ç²å¾—</p>
                    <p class="text-sm text-gray-600">ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</p>
                </div>
                <button id="buyPremiumCurrency" class="btn btn-premium text-base">è³¼å…¥ã™ã‚‹</button>
            </div>

            <div class="upgrade-item mt-4">
                <div>
                    <p class="font-bold text-lg">ç©¶æ¥µã®åŠ›</p>
                    <p class="text-sm text-gray-600">ã‚¯ãƒªãƒƒã‚¯ã‚ãŸã‚Šã®åŠ›ãŒ<span id="ultimatePowerValue">1000</span>å¢—åŠ </p>
                    <p class="text-sm text-gray-600">ã‚³ã‚¹ãƒˆ: <span id="ultimatePowerCost">50</span> ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨</p>
                </div>
                <button id="buyUltimatePower" class="btn btn-premium text-base">è³¼å…¥</button>
            </div>
        </div>
    </div>

    <div id="messageBox" class="message-box"></div>
    <div id="effectContainer"></div>

    <script>
        // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹å¤‰æ•°
        let power = 0; // ç¾åœ¨ã®åŠ›
        let premiumCurrency = 0; // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨
        let baseClickPower = 1; // åŸºæœ¬ã®ã‚¯ãƒªãƒƒã‚¯åŠ›
        let autoClickRate = 0; // è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯ã§æ¯ç§’ç²å¾—ã™ã‚‹åŠ›
        let ownedCharacters = []; // æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ãƒªã‚¹ãƒˆã€‚å„ã‚­ãƒ£ãƒ©ã¯ { id, name, attack, rarity, multiplier } ã‚’æŒã¤

        // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ (ãƒ™ãƒ¼ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹)
        const characters = [
            { id: 'char1', name: 'è¦‹ç¿’ã„å‰£å£«', attack: 5, rarity: 'Common' },
            { id: 'char2', name: 'è¦‹ç¿’ã„é­”æ³•ä½¿ã„', attack: 7, rarity: 'Common' },
            { id: 'char3', name: 'ç†Ÿç·´ã®æˆ¦å£«', attack: 15, rarity: 'Uncommon' },
            { id: 'char4', name: 'ç™’ã—ã®åƒ§ä¾¶', attack: 3, rarity: 'Uncommon' },
            { id: 'char5', name: 'ä¼èª¬ã®ãƒ‰ãƒ©ã‚´ãƒ³', attack: 50, rarity: 'Rare' },
            { id: 'char6', name: 'å½±ã®æš—æ®ºè€…', attack: 25, rarity: 'Rare' },
            { id: 'char7', name: 'è–ãªã‚‹é¨å£«', attack: 30, rarity: 'Rare' },
            { id: 'char8', name: 'å¤ä»£ã®è³¢è€…', attack: 40, rarity: 'Rare' }
        ];

        // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã‚³ã‚¹ãƒˆã¨åŠ¹æœ
        const upgrades = {
            clickPower: {
                cost: 10,
                effect: 1,
                level: 0
            },
            autoClick: {
                cost: 100,
                effect: 1,
                level: 0
            },
            ultimatePower: {
                cost: 50, // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ã§ã®ã‚³ã‚¹ãƒˆ
                effect: 1000,
                level: 0
            }
        };

        // ã‚¬ãƒãƒ£ã®ã‚³ã‚¹ãƒˆ
        const gachaCost = 500;
        const GACHA_DUPLICATE_MULTIPLIER_BONUS = 0.1; // åŒã˜ã‚­ãƒ£ãƒ©ã‚’å¼•ã„ãŸæ™‚ã®æ”»æ’ƒåŠ›å€ç‡å¢—åŠ é‡

        // DOMè¦ç´ ã®å–å¾—
        const powerDisplay = document.getElementById('powerDisplay');
        const premiumCurrencyDisplay = document.getElementById('premiumCurrencyDisplay');
        const currentClickPowerDisplay = document.getElementById('currentClickPowerDisplay'); // ç¾åœ¨ã®ã‚¯ãƒªãƒƒã‚¯åŠ›è¡¨ç¤º
        const clickButton = document.getElementById('clickButton');
        const messageBox = document.getElementById('messageBox');
        const effectContainer = document.getElementById('effectContainer'); // ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚³ãƒ³ãƒ†ãƒŠ
        const elapsedTimeDisplay = document.getElementById('elapsedTimeDisplay'); // çµŒéæ™‚é–“è¡¨ç¤ºè¦ç´ 

        // ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã¨è¡¨ç¤ºè¦ç´ 
        const buyClickPowerUpgradeBtn = document.getElementById('buyClickPowerUpgrade');
        const clickPowerUpgradeCostDisplay = document.getElementById('clickPowerUpgradeCost');
        const clickPowerUpgradeValueDisplay = document.getElementById('clickPowerUpgradeValue');

        const buyAutoClickUpgradeBtn = document.getElementById('buyAutoClickUpgrade');
        const autoClickCostDisplay = document.getElementById('autoClickCost');
        const autoClickValueDisplay = document.getElementById('autoClickValue');

        const buyPremiumCurrencyBtn = document.getElementById('buyPremiumCurrency');

        const buyUltimatePowerBtn = document.getElementById('buyUltimatePower');
        const ultimatePowerCostDisplay = document.getElementById('ultimatePowerCost');
        const ultimatePowerValueDisplay = document.getElementById('ultimatePowerValue');

        // ã‚¬ãƒãƒ£é–¢é€£DOMè¦ç´ 
        const drawGachaBtn = document.getElementById('drawGacha');
        const gachaCostDisplay = document.getElementById('gachaCost');
        const ownedCharactersList = document.getElementById('ownedCharactersList');

        // ã‚¨ãƒ•ã‚§ã‚¯ãƒˆç”¨ã®ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
        const particleColors = [
            ['#FFD700', '#FFA500'], // Gold to Orange
            ['#8A2BE2', '#4B0082'], // Blue Violet to Indigo
            ['#00CED1', '#40E0D0'], // Dark Turquoise to Turquoise
            ['#FF69B4', '#FF1493'], // Hot Pink to Deep Pink
            ['#7FFF00', '#32CD32']  // Chartreuse to Lime Green
        ];

        // ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ãŸæ™‚åˆ»
        const startTime = Date.now();

        /**
         * ç¾åœ¨ã®ç·ã‚¯ãƒªãƒƒã‚¯åŠ›ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°
         * baseClickPowerã€ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã€æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®æ”»æ’ƒåŠ›ã‚’åˆè¨ˆã—ã¾ã™ã€‚
         */
        function calculateTotalClickPower() {
            let total = baseClickPower;

            // ã‚¯ãƒªãƒƒã‚¯åŠ›å¼·åŒ–ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ã‚ˆã‚‹åŠ ç®—
            total += upgrades.clickPower.level * upgrades.clickPower.effect;

            // ç©¶æ¥µã®åŠ›ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã«ã‚ˆã‚‹åŠ ç®—
            total += upgrades.ultimatePower.level * upgrades.ultimatePower.effect;

            // æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®æ”»æ’ƒåŠ›ã¨å€ç‡ã«ã‚ˆã‚‹åŠ ç®—
            ownedCharacters.forEach(char => {
                total += char.attack * char.multiplier;
            });

            return Math.ceil(total); // å°æ•°ç‚¹ä»¥ä¸‹ã‚’åˆ‡ã‚Šä¸Šã’ã¦æ•´æ•°ã«ã™ã‚‹
        }

        // UIã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateUI() {
            powerDisplay.textContent = power.toLocaleString();
            premiumCurrencyDisplay.textContent = premiumCurrency.toLocaleString();
            currentClickPowerDisplay.textContent = calculateTotalClickPower().toLocaleString(); // è¨ˆç®—ã—ãŸã‚¯ãƒªãƒƒã‚¯åŠ›ã‚’è¡¨ç¤º

            // ã‚¯ãƒªãƒƒã‚¯åŠ›å¼·åŒ–ã®è¡¨ç¤ºæ›´æ–°
            clickPowerUpgradeCostDisplay.textContent = upgrades.clickPower.cost.toLocaleString();
            clickPowerUpgradeValueDisplay.textContent = upgrades.clickPower.effect.toLocaleString();
            buyClickPowerUpgradeBtn.disabled = power < upgrades.clickPower.cost;

            // è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯ã®è¡¨ç¤ºæ›´æ–°
            autoClickCostDisplay.textContent = upgrades.autoClick.cost.toLocaleString();
            autoClickValueDisplay.textContent = autoClickRate.toLocaleString();
            buyAutoClickUpgradeBtn.disabled = power < upgrades.autoClick.cost;

            // ç©¶æ¥µã®åŠ›ã®è¡¨ç¤ºæ›´æ–°
            ultimatePowerCostDisplay.textContent = upgrades.ultimatePower.cost.toLocaleString();
            ultimatePowerValueDisplay.textContent = upgrades.ultimatePower.effect.toLocaleString();
            buyUltimatePowerBtn.disabled = premiumCurrency < upgrades.ultimatePower.cost;

            // ã‚¬ãƒãƒ£ã®è¡¨ç¤ºæ›´æ–°
            gachaCostDisplay.textContent = gachaCost.toLocaleString();
            drawGachaBtn.disabled = power < gachaCost;

            // æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒªã‚¹ãƒˆã®æ›´æ–°
            ownedCharactersList.innerHTML = ''; // ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            if (ownedCharacters.length === 0) {
                ownedCharactersList.innerHTML = '<p class="text-gray-500 text-sm italic">ã¾ã ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã„ã¾ã›ã‚“ã€‚</p>';
            } else {
                ownedCharacters.forEach(char => {
                    const charItem = document.createElement('div');
                    charItem.className = 'character-item';
                    let multiplierText = '';
                    if (char.multiplier > 1) {
                        multiplierText = ` (x${char.multiplier.toFixed(1)}å€)`; // å€ç‡ã‚’è¡¨ç¤º
                    }
                    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®æ”»æ’ƒåŠ›è¡¨ç¤ºã‚’ã€å€ç‡ã‚’åæ˜ ã—ã¦åˆ‡ã‚Šä¸Šã’ãŸå€¤ã«ã™ã‚‹
                    const displayedAttack = Math.ceil(char.attack * char.multiplier);
                    charItem.innerHTML = `
                        <span class="font-medium">${char.name}</span>
                        <span class="text-sm text-gray-600">æ”»æ’ƒåŠ›: ${displayedAttack}${multiplierText}</span>
                    `;
                    ownedCharactersList.appendChild(charItem);
                });
            }
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
        function showMessage(message, duration = 2000) {
            messageBox.textContent = message;
            messageBox.classList.add('show');
            setTimeout(() => {
                messageBox.classList.remove('show');
            }, duration);
        }

        // ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function createClickEffect(x, y) {
            const numParticles = 5 + Math.floor(Math.random() * 5); // 5-9å€‹ã®ç²’å­
            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';

                // ãƒ©ãƒ³ãƒ€ãƒ ãªã‚µã‚¤ã‚º
                const size = 10 + Math.random() * 20; // 10pxã‹ã‚‰30px
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;

                // ãƒ©ãƒ³ãƒ€ãƒ ãªè‰²
                const colors = particleColors[Math.floor(Math.random() * particleColors.length)];
                particle.style.background = `radial-gradient(circle, ${colors[0]} 0%, ${colors[1]} 100%)`;

                // ã‚¯ãƒªãƒƒã‚¯ä½ç½®ã«é…ç½®
                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;

                // ãƒ©ãƒ³ãƒ€ãƒ ãªç§»å‹•é‡ (CSSå¤‰æ•°ã§ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«æ¸¡ã™)
                const translateX = (Math.random() - 0.5) * 100; // -50pxã‹ã‚‰50px
                const translateY = (Math.random() - 0.5) * 100; // -50pxã‹ã‚‰50px
                particle.style.setProperty('--translate-x', `${translateX}px`);
                particle.style.setProperty('--translate-y', `${translateY}px`);

                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®é…å»¶ã¨æŒç¶šæ™‚é–“ã‚’å°‘ã—ãƒ©ãƒ³ãƒ€ãƒ ã«ã™ã‚‹
                const animationDuration = 0.8 + Math.random() * 0.4; // 0.8sã‹ã‚‰1.2s
                particle.style.animationDuration = `${animationDuration}s`;
                const animationDelay = Math.random() * 0.2; // 0sã‹ã‚‰0.2s
                particle.style.animationDelay = `${animationDelay}s`;


                effectContainer.appendChild(particle);

                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†å¾Œã«è¦ç´ ã‚’å‰Šé™¤
                particle.addEventListener('animationend', () => {
                    particle.remove();
                });
            }
        }

        // çµŒéæ™‚é–“ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        function updateElapsedTime() {
            const now = Date.now();
            const elapsedMilliseconds = now - startTime;

            const ms = elapsedMilliseconds % 1000;
            const totalSeconds = Math.floor(elapsedMilliseconds / 1000);
            const seconds = totalSeconds % 60;
            const totalMinutes = Math.floor(totalSeconds / 60);
            const minutes = totalMinutes % 60;
            const totalHours = Math.floor(totalMinutes / 60);
            const hours = totalHours % 24;
            const days = Math.floor(totalHours / 24);

            // ãƒŸãƒªç§’ã‚’3æ¡ã«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
            const formattedMs = String(ms).padStart(3, '0');

            elapsedTimeDisplay.textContent = `${days}æ—¥${hours}æ™‚é–“${minutes}åˆ†${seconds}ç§’,${formattedMs}ç§’`;
        }

        // ã‚¯ãƒªãƒƒã‚¯ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        clickButton.addEventListener('click', (event) => {
            power += calculateTotalClickPower(); // è¨ˆç®—ã—ãŸã‚¯ãƒªãƒƒã‚¯åŠ›ã‚’ä½¿ç”¨
            updateUI();
            showMessage(`+${calculateTotalClickPower()} åŠ›ï¼`); // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚è¨ˆç®—ã—ãŸã‚¯ãƒªãƒƒã‚¯åŠ›ã§è¡¨ç¤º

            // ã‚¯ãƒªãƒƒã‚¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ
            createClickEffect(event.clientX, event.clientY);
        });

        // ã‚¯ãƒªãƒƒã‚¯åŠ›å¼·åŒ–ã®è³¼å…¥
        buyClickPowerUpgradeBtn.addEventListener('click', () => {
            if (power >= upgrades.clickPower.cost) {
                power -= upgrades.clickPower.cost;
                upgrades.clickPower.level++; // ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹
                upgrades.clickPower.cost = Math.floor(upgrades.clickPower.cost * 1.5); // ã‚³ã‚¹ãƒˆå¢—åŠ 
                showMessage(`ã‚¯ãƒªãƒƒã‚¯åŠ›å¼·åŒ–ï¼`);
                updateUI(); // UIæ›´æ–°æ™‚ã«ã‚¯ãƒªãƒƒã‚¯åŠ›ãŒå†è¨ˆç®—ã•ã‚Œã‚‹
            } else {
                showMessage('åŠ›ãŒè¶³ã‚Šã¾ã›ã‚“ï¼');
            }
        });

        // è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯ã®è³¼å…¥
        buyAutoClickUpgradeBtn.addEventListener('click', () => {
            if (power >= upgrades.autoClick.cost) {
                power -= upgrades.autoClick.cost;
                autoClickRate += upgrades.autoClick.effect;
                upgrades.autoClick.cost = Math.floor(upgrades.autoClick.cost * 1.8); // ã‚³ã‚¹ãƒˆå¢—åŠ 
                upgrades.autoClick.level++;
                showMessage(`è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯è³¼å…¥ï¼ æ¯ç§’ ${autoClickRate} åŠ›ç²å¾—ï¼`);
                updateUI();
            } else {
                showMessage('åŠ›ãŒè¶³ã‚Šã¾ã›ã‚“ï¼');
            }
        });

        // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ã®è³¼å…¥ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
        buyPremiumCurrencyBtn.addEventListener('click', () => {
            premiumCurrency += 100; // 100ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ã‚’ä»˜ä¸
            showMessage('ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ã‚’100è³¼å…¥ã—ã¾ã—ãŸï¼');
            updateUI();
        });

        // ç©¶æ¥µã®åŠ›ã®è³¼å…¥
        buyUltimatePowerBtn.addEventListener('click', () => {
            if (premiumCurrency >= upgrades.ultimatePower.cost) {
                premiumCurrency -= upgrades.ultimatePower.cost;
                upgrades.ultimatePower.level++; // ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹
                // ç©¶æ¥µã®åŠ›ã¯ä¸€åº¦ã—ã‹è²·ãˆãªã„ã€ã¾ãŸã¯ã‚³ã‚¹ãƒˆãŒæ€¥å¢—ã™ã‚‹ãªã©ã€èª¿æ•´ãŒå¿…è¦
                // ã“ã“ã§ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«ãƒ¬ãƒ™ãƒ«ã‚’ä¸Šã’ã‚‹ã ã‘
                showMessage(`ç©¶æ¥µã®åŠ›ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼`);
                updateUI(); // UIæ›´æ–°æ™‚ã«ã‚¯ãƒªãƒƒã‚¯åŠ›ãŒå†è¨ˆç®—ã•ã‚Œã‚‹
            } else {
                showMessage('ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é€šè²¨ãŒè¶³ã‚Šã¾ã›ã‚“ï¼');
            }
        });

        // ã‚¬ãƒãƒ£ã‚’å¼•ã
        drawGachaBtn.addEventListener('click', () => {
            if (power >= gachaCost) {
                power -= gachaCost;

                // ãƒ©ãƒ³ãƒ€ãƒ ã«ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’é¸æŠ
                const randomIndex = Math.floor(Math.random() * characters.length);
                const newCharacterBase = characters[randomIndex]; // ãƒ™ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿

                // æ‰€æŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ä¸­ã«åŒã˜IDã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                let existingChar = ownedCharacters.find(char => char.id === newCharacterBase.id);

                if (existingChar) {
                    // åŒã˜ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒã„ãŸå ´åˆã€å€ç‡ã‚’ä¸Šã’ã‚‹
                    existingChar.multiplier = parseFloat((existingChar.multiplier + GACHA_DUPLICATE_MULTIPLIER_BONUS).toFixed(1));
                    showMessage(`${existingChar.name} ã®æ”»æ’ƒåŠ›ãŒ x${existingChar.multiplier.toFixed(1)}å€ ã«ãªã‚Šã¾ã—ãŸï¼`);
                } else {
                    // æ–°ã—ã„ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å ´åˆã€ãƒªã‚¹ãƒˆã«è¿½åŠ 
                    const newOwnedChar = { ...newCharacterBase, multiplier: 1.0 }; // æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦å€ç‡1.0ã§è¿½åŠ 
                    ownedCharacters.push(newOwnedChar);
                    showMessage(`${newCharacterBase.name} ã‚’ç²å¾—ã—ã¾ã—ãŸï¼ (æ”»æ’ƒåŠ›: ${newCharacterBase.attack})`);
                }
                updateUI(); // UIæ›´æ–°æ™‚ã«ã‚¯ãƒªãƒƒã‚¯åŠ›ãŒå†è¨ˆç®—ã•ã‚Œã‚‹
            } else {
                showMessage(`ã‚¬ãƒãƒ£ã‚’å¼•ãã«ã¯ ${gachaCost} åŠ›ãŒå¿…è¦ã§ã™ï¼`);
            }
        });

        // è‡ªå‹•ã‚¯ãƒªãƒƒã‚¯ã®ã‚¿ã‚¤ãƒãƒ¼
        setInterval(() => {
            power += autoClickRate;
            updateUI();
        }, 1000); // 1ç§’ã”ã¨ã«å®Ÿè¡Œ

        // çµŒéæ™‚é–“ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®ã‚¿ã‚¤ãƒãƒ¼ (10ãƒŸãƒªç§’ã”ã¨ã«æ›´æ–°)
        setInterval(updateElapsedTime, 10);

        // åˆæœŸUIã®æ›´æ–°
        updateUI();
        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ä¸€åº¦çµŒéæ™‚é–“ã‚’æ›´æ–°
        updateElapsedTime();
    </script>
</body>
</html>
